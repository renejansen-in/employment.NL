-- join jobseekers (E+W) - Detail = Province
SELECT 	IFNULL(e.BEROEP_CD, w.BEROEP_CD) AS BEROEP_CD,
		IFNULL(e.REFERENTIEBEROEP, w.REFERENTIEBEROEP) AS REFERENTIEBEROEP,
        IFNULL(e.BEROEPENCLUSTER_CD, w.BEROEPENCLUSTER_CD) AS BEROEPENCLUSTER_CD,
        IFNULL(e.BEROEPENCLUSTER, w.BEROEPENCLUSTER) AS BEROEPENCLUSTER,
		IFNULL(e.POSTCODEGEBIED, w.POSTCODEGEBIED) AS POSTCODEGEBIED,
        IFNULL(e.GEMEENTE, w.GEMEENTE) AS GEMEENTE,
        IFNULL(e.PROVINCIE, w.PROVINCIE) AS PROVINCIE,
        (IFNULL(e.AANTAL,0))+(IFNULL(w.AANTAL,0)) AS AANT_EW,
        IFNULL(e.AANTAL_MAN,0) AS MAN_E,
        IFNULL(e.AANTAL_VROUW,0) AS VROUW_E,
        IFNULL(w.AANTAL_MAN,0) AS MAN_W,
        IFNULL(w.AANTAL_VROUW,0) AS VROUW_W,
        IFNULL(e.AANT_LEEFT_TOT_27,0) AS LEEFT_E_27,
        IFNULL(e.AANT_LEEFT_28_39,0) AS LEEFT_E_28_39,
        IFNULL(e.AANT_LEEFT_40_49,0) AS LEEFT_E_40_49,
        IFNULL(e.AANT_LEEFT_50_PLUS,0) AS LEEFT_E_50_PL,
        IFNULL(e.AANT_LEEFT_ONBEKEND,0) AS LEEFT_E_ONB,
        IFNULL(e.AANT_OPLNIV_1,0) AS OPL_E1,        
        IFNULL(e.AANT_OPLNIV_2,0) AS OPL_E2,      
        IFNULL(e.AANT_OPLNIV_3,0) AS OPL_E3,        
        IFNULL(e.AANT_OPLNIV_4,0) AS OPL_E4,         
        IFNULL(e.AANT_OPLNIV_5,0) AS OPL_E5,        
        IFNULL(e.AANT_OPLNIV_6,0) AS OPL_E6,
        IFNULL(e.AANT_WE_0_1,0) AS WE_0_1,        
        IFNULL(e.AANT_WE_1_3,0) AS WE_1_3, 
        IFNULL(e.AANT_WE_3_6,0) AS WE_3_6, 
        IFNULL(e.AANT_WE_7,0) AS WE_7,
        IFNULL(e.AANT_WE_ONBEKEND,0) AS WE_ONB,
        IFNULL(e.AANT_UPW_0_8,0) AS UPW_0_8,
        IFNULL(e.AANT_UPW_9_16,0) AS UPW_9_16,
        IFNULL(e.AANT_UPW_17_24,0) AS UPW_17_24,
        IFNULL(e.AANT_UPW_25_32,0) AS UPW_25_32,
        IFNULL(e.AANT_UPW_33_PLUS,0) AS UPW_33_PL,         
        IFNULL(w.AANT_LEEFT_TOT_27,0) AS LEEFT_W_27,
        IFNULL(w.AANT_LEEFT_28_39,0) AS LEEFT_W_28_39,
        IFNULL(w.AANT_LEEFT_40_49,0) AS LEEFT_W_40_49,
        IFNULL(w.AANT_LEEFT_50_PLUS,0) AS LEEFT_W_50_PL,
        IFNULL(w.AANT_LEEFT_ONBEKEND,0) AS LEEFT_W_ONB,
        IFNULL(w.AANT_OPLNIV_1,0) AS OPL_W1,        
        IFNULL(w.AANT_OPLNIV_2,0) AS OPL_W2,      
        IFNULL(w.AANT_OPLNIV_3,0) AS OPL_W3,        
        IFNULL(w.AANT_OPLNIV_4,0) AS OPL_W4,         
        IFNULL(w.AANT_OPLNIV_5,0) AS OPL_W5,        
        IFNULL(w.AANT_OPLNIV_6,0) AS OPL_W6
FROM uwv_e AS e
LEFT JOIN uwv_w w 
ON w.BEROEP_CD = e.BEROEP_CD
AND w.PROVINCIE = e.PROVINCIE
WHERE e.POSTCODEGEBIED = 0 AND e.GEMEENTE = 'NL' AND e.PROVINCIE <> 'NL'
-- returns NULL on right when there is E and no W
UNION ALL
SELECT 	IFNULL(e.BEROEP_CD, w.BEROEP_CD) AS BEROEP_CD,
		IFNULL(e.REFERENTIEBEROEP, w.REFERENTIEBEROEP) AS REFERENTIEBEROEP,
        IFNULL(e.BEROEPENCLUSTER_CD, w.BEROEPENCLUSTER_CD) AS BEROEPENCLUSTER_CD,
        IFNULL(e.BEROEPENCLUSTER, w.BEROEPENCLUSTER) AS BEROEPENCLUSTER,
		IFNULL(e.POSTCODEGEBIED, w.POSTCODEGEBIED) AS POSTCODEGEBIED,
        IFNULL(e.GEMEENTE, w.GEMEENTE) AS GEMEENTE,
        IFNULL(e.PROVINCIE, w.PROVINCIE) AS PROVINCIE,
        (IFNULL(e.AANTAL,0))+(IFNULL(w.AANTAL,0)) AS AANT_EW,
        IFNULL(e.AANTAL_MAN,0) AS MAN_E,
        IFNULL(e.AANTAL_VROUW,0) AS VROUW_E,
        IFNULL(w.AANTAL_MAN,0) AS MAN_W,
        IFNULL(w.AANTAL_VROUW,0) AS VROUW_W,
        IFNULL(e.AANT_LEEFT_TOT_27,0) AS LEEFT_E_27,
        IFNULL(e.AANT_LEEFT_28_39,0) AS LEEFT_E_28_39,
        IFNULL(e.AANT_LEEFT_40_49,0) AS LEEFT_E_40_49,
        IFNULL(e.AANT_LEEFT_50_PLUS,0) AS LEEFT_E_50_PL,
        IFNULL(e.AANT_LEEFT_ONBEKEND,0) AS LEEFT_E_ONB,
        IFNULL(e.AANT_OPLNIV_1,0) AS OPL_E1,        
        IFNULL(e.AANT_OPLNIV_2,0) AS OPL_E2,      
        IFNULL(e.AANT_OPLNIV_3,0) AS OPL_E3,        
        IFNULL(e.AANT_OPLNIV_4,0) AS OPL_E4,         
        IFNULL(e.AANT_OPLNIV_5,0) AS OPL_E5,        
        IFNULL(e.AANT_OPLNIV_6,0) AS OPL_E6,
        IFNULL(e.AANT_WE_0_1,0) AS WE_0_1,        
        IFNULL(e.AANT_WE_1_3,0) AS WE_1_3, 
        IFNULL(e.AANT_WE_3_6,0) AS WE_3_6, 
        IFNULL(e.AANT_WE_7,0) AS WE_7,
        IFNULL(e.AANT_WE_ONBEKEND,0) AS WE_ONB,
        IFNULL(e.AANT_UPW_0_8,0) AS UPW_0_8,
        IFNULL(e.AANT_UPW_9_16,0) AS UPW_9_16,
        IFNULL(e.AANT_UPW_17_24,0) AS UPW_17_24,
        IFNULL(e.AANT_UPW_25_32,0) AS UPW_25_32,
        IFNULL(e.AANT_UPW_33_PLUS,0) AS UPW_33_PL,         
        IFNULL(w.AANT_LEEFT_TOT_27,0) AS LEEFT_W_27,
        IFNULL(w.AANT_LEEFT_28_39,0) AS LEEFT_W_28_39,
        IFNULL(w.AANT_LEEFT_40_49,0) AS LEEFT_W_40_49,
        IFNULL(w.AANT_LEEFT_50_PLUS,0) AS LEEFT_W_50_PL,
        IFNULL(w.AANT_LEEFT_ONBEKEND,0) AS LEEFT_W_ONB,
        IFNULL(w.AANT_OPLNIV_1,0) AS OPL_W1,        
        IFNULL(w.AANT_OPLNIV_2,0) AS OPL_W2,      
        IFNULL(w.AANT_OPLNIV_3,0) AS OPL_W3,        
        IFNULL(w.AANT_OPLNIV_4,0) AS OPL_W4,         
        IFNULL(w.AANT_OPLNIV_5,0) AS OPL_W5,        
        IFNULL(w.AANT_OPLNIV_6,0) AS OPL_W6
FROM uwv_e AS e
RIGHT JOIN uwv_w w 
ON w.BEROEP_CD = e.BEROEP_CD
AND w.PROVINCIE = e.PROVINCIE
WHERE e.BEROEP_CD IS NULL OR e.POSTCODEGEBIED = 0 AND e.GEMEENTE = 'NL' AND e.PROVINCIE <> 'NL'
-- returns NULL on left when there is W and no E
-- all together return job seekers e and w without postal code and gemeente
;
